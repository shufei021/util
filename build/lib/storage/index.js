!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).storage=t()}(this,function(){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"==typeof e?e:String(e)}(i.key),i)}}return new(function(){function e(){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");this._p=JSON.parse,this._s=JSON.stringify,this._set=localStorage.setItem.bind(localStorage),this._get=localStorage.getItem.bind(localStorage),this._del=localStorage.removeItem.bind(localStorage)}var t,r,i;return t=e,(r=[{key:"_parse",value:function(e){return this._p(this._get(e))}},{key:"isObject",value:function(e){return"object"===Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}},{key:"HAS",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:localStorage;return Object.prototype.hasOwnProperty.call(t,e)}},{key:"_e",value:function(e,t,r){this._set(e,this._s({startTime:+new Date,expiredTime:r,value:t,STOREFLAG:!0}))}},{key:"set",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var i=t.length;if(i){var n=t[0],a=t[1],l=t[2];if(this.isObject(n)){if(Object.keys(n).length)for(var o in n)2<=i&&void 0!==a?this._e(o,n[o],a):this.set(o,n[o])}else 1!==i&&(3<=i&&void 0!==l?this._e(n,a,l):this._set(n,this.isObject(a)||Array.isArray(a)?this._s(a):a))}}},{key:"get",value:function(){for(var i=this,e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];if(t.length){var n=t.length,a=t[0],l=t[1],o=Array.isArray(a),s=this.isObject(l),u=s&&this.HAS("default",l),f=s&&this.HAS("expired",l);if(o){if(!a.length)return 2<=n?l:{};for(var c={},h=0;h<a.length;h++){var y=a[h];this.HAS(y)&&(c[y]=this.get(y))}return Object.keys(c).length?2<=n&&f&&!0===l.expired?Object.keys(c).reduce(function(e,t){var r=i.getExpired(t);return r&&(e[t]=i.isObject(c[t])&&i.HAS("STOREFLAG",c[t])?r:c[t]),e},{}):c:2<=n&&u?l.default:2<=n&&!s?l:{}}var o=null,g=this._get(a);try{o=/^[+-]?\d+(\.\d+)?$/.test(g)?g:this._parse(a)}catch(e){o=g}return 1===n?this.isObject(o)||Array(o)||"boolean"==typeof o?o:g:s?null===o?u?l.default:o:f&&!0===l.expired&&this.isObject(o)&&this.HAS("STOREFLAG",o)?this.getExpired(a):o:null===o?l:o}}},{key:"del",value:function(e){if("string"==typeof e)this._del(e);else if(Array.isArray(e))for(var t=0,r=e.length;t<r;t++){var i=e[t];"string"==typeof i&&this._del(i)}}},{key:"clear",value:function(e){if(e)for(var t=Object.keys(localStorage),r=t.length,i=0;i<r;i++)this.getExpired(t[i]);else localStorage.clear()}},{key:"getExpired",value:function(e){var t=this._parse(e);return this.isObject(t)&&this.HAS("STOREFLAG",t)?new Date-t.startTime>t.expiredTime?(this._del(e),null):t.value:null}},{key:"each",value:function(e){for(var t=Object.keys(localStorage),r=0,i=t.length;r<i;r++){var n=t[r];e(n,this._parse(n))}}},{key:"once",value:function(e,t){t=this._get(e,t);if("string"==typeof e&&this.HAS(e))this._del(e);else if(Array.isArray(e)&&e.length)for(var r=0;r<e.length;r++)this.HAS(e[r])&&this._del(e[r]);return t}}])&&n(t.prototype,r),i&&n(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}())});
