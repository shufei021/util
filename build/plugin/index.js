!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).rplugin=e()}(this,function(){"use strict";function t(t){this.timer=null,this.ft=t.format||"dd天hh时mm分ss秒",this.list=t.list||[],this.key=t.timeKey,this.type=t.type,this.update()}function e(){this._events={}}return t.prototype.update=function(){this.operation(1)},t.prototype.cancel=function(){this.operation(0)},t.prototype.calc=function(t){var e=t[this.key],e=new Date(e.replace(/-/g,"/")).getTime()/1e3-Date.parse(new Date)/1e3,r={d:Math.floor(e/86400)<=0?"00":Math.floor(e/86400),h:parseInt(Math.floor(e%86400/3600))<=0?"00":String(parseInt(Math.floor(e%86400/3600))).padStart(2,0),m:parseInt(Math.floor(e%86400%3600)/60)<=0?"00":String(parseInt(Math.floor(e%86400%3600)/60)).padStart(2,0),s:parseInt(e%60)<=0?"00":String(parseInt(e%60)).padStart(2,0)};if(1==this.type)return this.ft.replace(/d|h{1,2}|m{1,2}|s{1,2}|S/g,function(t){return"d"===t[0]||2===t.length?r[t[0]]:Number(r[t[0]])});t.d=r.d,t.h=r.h,t.m=r.m,t.s=r.s},t.prototype.operation=function(t){var e=this;0==t?(clearInterval(this.timer),this.timer=null):1==t&&(this.timer&&clearInterval(this.timer),this.timer=setInterval(function(){for(var t=0;t<e.list.length;t++)1==e.type?e.list[t].end=e.calc(e.list[t]):e.calc(e.list[t])},1e3))},e.prototype.on=function(t,e){this._events||(this._events={}),this._events[t]?this._events[t].push(e):this._events[t]=[e]},e.prototype.emit=function(t){for(var e=arguments.length,r=new Array(1<e?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];this._events||(this._events={}),this._events[t].forEach(function(t){return t.apply(void 0,r)})},e.prototype.off=function(t,e){this._events||(this._events={}),this._events[t]&&(this._events[t]=this._events[t].filter(function(t){return t!==e&&t.l!==e}))},e.prototype.once=function(t,e){function r(){e.apply(void 0,arguments),n.off(t,r)}var n=this;this._events||(this._events={});r.l=e,this.on(t,r)},{Countdown:t,Emitter:e,ImgLazyLoad:function(){var r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=Array.isArray(r.items)?r.items:document.querySelectorAll(r.items),s=new IntersectionObserver(function(t){t.forEach(function(t){var e;t.isIntersecting&&((e="IMG"===t.target.tagName?t.target:t.target.querySelector("img"))&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),s.unobserve(t.target),t.target===n[n.length-1])&&r.loadData().then(function(){var t=document.querySelectorAll(r.itemClass),e=function(t,e){for(var r=t.length-1;0<=r;r--)if(e(t[r]))return r;return-1}(t,function(t){return!("IMG"===t.tagName?t:t.querySelector("img")).getAttribute("data-src")});imgLazyLoad({itemClass:r.itemClass,scrollerClassClass:"string"==typeof r.scrollerClass?document.querySelector(r.scrollerClass):r.scrollerClass,items:Array.from(t).slice(e+1),loadData:r.loadData})})})},{root:"string"==typeof r.scrollerClass?document.querySelector(r.scrollerClass):r.scrollerClass||null});Array.from(n).forEach(function(t){s.observe(t)})}}});
