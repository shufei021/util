<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>lodash节流和防抖</title>
    <style>
        .box {
            width: 500px;
            height: 500px;
            background-color: #ccc;
            color: #fff;
            text-align: center;
            font-size: 100px;
        }
        p > .s1,
        p > .s2,
        p > .s3 {
            color: red;
        } 
        p > :is(.s1, .s2, .s3) {
        color: red;
        }
    </style>
</head>

<body>
    <p>p标签<span class="s1">s1的内容</span></p>
    <p>p标签<span class="s2">s1的内容</span></p>
    <p>p标签<span class="s3">s1的内容</span></p>
    <!-- <img src="" alt=""> -->
    <div class="box"></div>
    <script>
        const box = document.querySelector('.box')
        let i = 1

        //数值加1
        function mouseMove() {
            box.innerHTML = ++i
        }

        function debounce(fn, delay, immediate) {
            let timer = null
            let cancelFunc = function(...args){
                clearTimeout(timer)
                if(immediate){
                    let is = !timer
                    timer = setTimeout(() => {
                        timer = null
                        is = null
                    },delay)
                    if(is) fn.apply(this, args)
                } else{
                    timer = setTimeout(() => {
                        fn.apply(this, args)
                    }, delay)
                }
            }
            cancelFunc.cancel = function(){
                clearTimeout(timer)
                timer = null
                cancelFunc = null
            }
            return cancelFunc
        }

        // function throttle (fn, wait) {
        //     let timer;
        //     return function (...args) {
        //         console.log('%c [ 1 ]-62', 'font-size:13px; background:pink; color:#bf2c9f;', )
        //         // 如果不存在 timer 表示当前不在周期内
        //         if (!timer) {
        //             // 开始一个新周期
        //             timer = setTimeout(() => {
        //                 fn.apply(this, args);
        //                 // 周期结束
        //                 clearTimeout(timer);
        //                 timer = null;
        //             }, wait);
        //         }
        //     }
        // }
        function thtottle(fn, delay) {
            var Cur = 0;
            return function () {
                var args = [];
                for (var _i = 0; _i < arguments.length; _i++) {
                    args[_i] = arguments[_i];
                }
                var Now = +new Date();
                var diff = Now - Cur;
                if (diff > delay) {
                    fn.apply(this, args);
                    Cur = Now;
                }
            };
        }

        // lodash 节流
        box.addEventListener('mousemove', thtottle(mouseMove, 500))
        // console.log('%c [ [1, 2, 3] ]-77', 'font-size:13px; background:pink; color:#bf2c9f;', [1, 2, 3])
        function combinations(nums) {
            let ret = [[]]
            for(let i = 0; i < nums.length; i++) {
                for(let j = 0, len = ret.length; j < len; j++) {
                    const item = [...ret[j], nums[i]]
                    ret.push(item)
                }
            }
            return ret
        }


    function flat(arr,deep){
        return arr.reduce((pre,cur)=>{
            return pre.concat(Array.isArray(cur)?flat(cur,deep-1):cur)
        },[])
    }
    </script>
</body>

</html>
